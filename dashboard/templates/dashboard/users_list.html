{% extends "dashboard/base.html" %}
{% load dashboard_extras %}
{% block title %}Users{% endblock %}

{% block content %}
<div class="d-flex align-items-center justify-content-between mb-3">
  <h3 class="mb-0"><i class="fas fa-users me-2"></i>Users</h3>
</div>

<div class="card">
  <div class="card-body p-0">
    <table class="table table-striped mb-0">
      <thead>
        <tr>
          <th>User</th>
          <th>Email</th>
          <th>Total Orders</th>
          <th>Total Spent</th>
        </tr>
      </thead>
      <tbody>
        {% for user in page_obj.object_list %}
        <tr>
          <td>{{ user.get_full_name|default:user.username }}</td>
          <td>{{ user.email }}</td>
          <td>
            <span class="badge bg-info">{{ user.total_orders }}</span>
          </td>
          <td>
            ${{ spent|get_item:user.id|default:0|floatformat:2 }}
          </td>
        </tr>
        {% empty %}
        <tr><td colspan="4" class="text-center py-4">No users found.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<nav>
  <ul class="pagination">
    {% if page_obj.has_previous %}
      <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}">Previous</a></li>
    {% endif %}
    <li class="page-item disabled"><span class="page-link">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span></li>
    {% if page_obj.has_next %}
      <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}">Next</a></li>
    {% endif %}
  </ul>
</nav>
{% endblock %}
